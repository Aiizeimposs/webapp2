<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; background-color: #fdf6f6; }
    label, select, input { margin: 5px 0; display: block; }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { padding: 10px; border: 1px solid #ddd; }
    th { background-color: #f2f2f2; }
  </style>
</head>
<body>

  <h2>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>

  <label for="className">‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</label>
  <select id="className">
    <option value="‡∏°.1/1">‡∏°.1/1</option>
    <option value="‡∏°.1/2">‡∏°.1/2</option>
    <option value="‡∏°.1/3">‡∏°.1/3</option>
    <option value="‡∏°.2/1">‡∏°.2/1</option>
    <option value="‡∏°.2/2">‡∏°.2/2</option>
    <option value="‡∏°.2/3">‡∏°.2/3</option>
  </select>

  <label for="date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (YYYY-MM-DD):</label>
  <input type="date" id="date">

  <button onclick="loadAttendance()">‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>

  <div id="result" style="margin-top: 20px;"></div>

  <script>
    function loadAttendance() {
      const className = document.getElementById('className').value;
      const dateText = document.getElementById('date').value;

      if (!dateText) {
        document.getElementById('result').innerHTML = '‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà';
        return;
      }

      const url = `https://script.google.com/macros/s/AKfycbzmQQdkY4f9aC5NCOw4gK0dYc-Do3cQSgRPlBHyIkxFVIJpjEX8wgyhgU6M6-_jSDwfig/exec?api=true&class=${encodeURIComponent(className)}&date=${encodeURIComponent(dateText)}`;

      fetch(url)
        .then(res => res.json())
        .then(data => {
          if (data.error) {
            document.getElementById('result').innerHTML = `‚ùå ${data.error}`;
          } else {
            document.getElementById('result').innerHTML = data.html;
          }
        })
        .catch(err => {
          document.getElementById('result').innerHTML = 'üö´ ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + err.message;
        });
    }
  </script>

</body>
</html>
