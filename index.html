<!DOCTYPE html>
<html>
  <head>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
      }
      table {
        border-collapse: collapse;
        width: 100%;
      }
      th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;
      }
    </style>
  </head>
  <body>
    <h2>ระบบเช็คชื่อ</h2>
    <label for="className">เลือกชั้นเรียน: </label>
    <select id="className">
      <option value="ม.1/1">ม.1/1</option>
      <option value="ม.1/2">ม.1/2</option>
      <option value="ม.1/3">ม.1/3</option>
      <option value="ม.2/1">ม.2/1</option>
      <option value="ม.2/2">ม.2/2</option>
      <option value="ม.2/3">ม.2/3</option>
    </select>
    <br><br>
    <label for="date">เลือกวันที่: </label>
    <input type="date" id="date" />
    <br><br>
    <button onclick="fetchAttendance()">แสดงข้อมูล</button>
    <div id="attendanceData"></div>

    <script>
      function fetchAttendance() {
        const className = document.getElementById('className').value;
        const date = document.getElementById('date').value;
        const url = `https://script.google.com/macros/s/AKfycbzmQQdkY4f9aC5NCOw4gK0dYc-Do3cQSgRPlBHyIkxFVIJpjEX8wgyhgU6M6-_jSDwfig/exec?class=${className}&date=${date}`;
        
        fetch(url)
          .then(response => response.text())
          .then(data => {
            document.getElementById('attendanceData').innerHTML = data;
          })
          .catch(error => console.error('Error fetching data:', error));
      }
    </script>
  </body>
</html>
